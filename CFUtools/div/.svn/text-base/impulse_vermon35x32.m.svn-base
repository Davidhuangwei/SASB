%
% This function returns the two way impulse response of the vermon 35x32 element transducer.
%
% h = impulse_vermon35x32 (fs)
% fs: sampling frequency of the output impulse response (h).
% The original impulse response is sampled at 70MHz.
%
% 2011-11-02 - MFR: Init version
%
%

function h_out = impulse_vermon35x32 (fs)
h = [ ...
    -0.0000000000000000000000000000000000000, ...
    -0.0000105536426533062071609660181881196, ...
    -0.0000282532519108766346492035703708012, ...
    -0.0000325886001865229789310404728830406, ...
    -0.0000169877014517353214478456030489539, ...
    00.0000080654213831527768533953895446764, ...
    00.0000179628929600956320088329942752381, ...
    -0.0000256084268302138457742891247681527, ...
    -0.0001666634280764676381749594957781824, ...
    -0.0004366238300023455231810287635596524, ...
    -0.0007989265064144868838669211186243047, ...
    -0.0011404621373359293771271305573122845, ...
    -0.0012933013336047206268825116026732758, ...
    -0.0010512015246997334031592297165502714, ...
    -0.0002428311863307990362513544280176347, ...
    00.0012570764939520615282447790761466422, ...
    00.0034785104790812006875233564073823800, ...
    00.0061820706503620537208831819953047670, ...
    00.0089735607605658743862742099395291007, ...
    00.0114373844488594843954443192046710465, ...
    00.0131581236021283860815334065819115494, ...
    00.0136501942711280792319694654679551604, ...
    00.0124932360054385571679347322060493752, ...
    00.0095067496691953884413450737156381365, ...
    00.0048258824452904842614020530788820906, ...
    -0.0011994584526522343061183395462876433, ...
    -0.0078805944044957540461915357354882872, ...
    -0.0143182087879296631588443844407265715, ...
    -0.0195226102954219292440196653615203104, ...
    -0.0227865235278165746690692827769453288, ...
    -0.0238943438705432470436917924416775350, ...
    -0.0231295187585404370123054462737854919, ...
    -0.0209693159612989211970646152849440114, ...
    -0.0180798820242658378476541258805809775, ...
    -0.0159727978153408993466921828030535835, ...
    -0.0166324239937099757624672236033802619, ...
    -0.0210391034601404985915351630865188781, ...
    -0.0278664795327990474915758056795311859, ...
    -0.0334580260423801081892669628814473981, ...
    -0.0332392737937880211607222236125380732, ...
    -0.0234264184261330256353605960839558975, ...
    -0.0016026217423435204587761626626729594, ...
    00.0333981949417666776347424217874504393, ...
    00.0818170128097684690171575994099839590, ...
    00.1413623171115705734468548371296492405, ...
    00.2044636468775768711747531369837815873, ...
    00.2570370647912851302940850928280269727, ...
    00.2809432332764151274417940840066876262, ...
    00.2595323577488627408982324595854151994, ...
    00.1842940403042080399487190334184560925, ...
    00.0581995434699008745704773559737077449, ...
    -0.1056951601107619514996471821177692618, ...
    -0.2882357556751247718018760224367724732, ...
    -0.4668133732434280314116392673895461485, ...
    -0.6154544383348896641194869516766630113, ...
    -0.7059978374527159372675555459863971919, ...
    -0.7127592058085975290637748003064189106, ...
    -0.6203754637030032270672563754487782717, ...
    -0.4309052315135901145559671476803487167, ...
    -0.1656696222688058828254042964545078576, ...
    00.1395670020909428321598255706703639589, ...
    00.4437595809764401932895339086826425046, ...
    00.7084162958891827566176857544633094221, ...
    00.9017618928625363849960194784216582775, ...
    00.9999882884955553219441526380251161754, ...
    00.9888791520027746528853640484157949686, ...
    00.8666829151060019276187063042016234249, ...
    00.6470752465872889880316165545082185417, ...
    00.3589814052584229808751103973918361589, ...
    00.0418866724386627725662535226547333878, ...
    -0.2625708922506371223448695673141628504, ...
    -0.5186689930406066517676322291663382202, ...
    -0.7012708473514247531355181308754254133, ...
    -0.7969291928380242140406153339426964521, ...
    -0.8027428941079418622805974337097723037, ...
    -0.7252156706065253644055701442994177341, ...
    -0.5797859581130444528440648355172015727, ...
    -0.3899679770588210803161643980274675414, ...
    -0.1841992821595678508916904547731974162, ...
    00.0092159192458805549996725403616437688, ...
    00.1668427715978524905615643092460231856, ...
    00.2732376282099753250776075219619087875, ...
    00.3219855861690024689814038083568448201, ...
    00.3154506948709124292129502009629504755, ...
    00.2635707706505276970432305461145006120, ...
    00.1821333052517183637153408426456735469, ...
    00.0902921890522315057081570444097451400, ...
    00.0070297343809371587095014000112769281, ...
    -0.0525386928560912860874942964528599987, ...
    -0.0799407732461755171637918238047859631, ...
    -0.0741519162784084473472034915175754577, ...
    -0.0402258811588041345630450962289614836, ...
    00.0127580090519525696929337144069904753, ...
    00.0735825010772663268276971848536049947, ...
    00.1301634492750863292265250947821186855, ...
    00.1708271894801354495729839300111052580, ...
    00.1864676573843720430723180925269844010, ...
    00.1731100978895230568799235015831072815, ...
    00.1333952834976093460017665393024799414, ...
    00.0753401019046558290126469614733650815, ...
    00.0097188773543600091159300191634429211, ...
    -0.0527269965832417655815511636774317594, ...
    -0.1031185187764029342893934426683699712, ...
    -0.1351003239536721356461868026599404402, ...
    -0.1450483351012026023152401421612012200, ...
    -0.1321495849729269755901128746700123884, ...
    -0.0991430908151767625868799882482562680, ...
    -0.0524227485982436264277950499490543734, ...
    -0.0010332323616262070915816639882223171, ...
    00.0452872912469170219029734880678006448, ...
    00.0785928742698233095964610583905596286, ...
    00.0940649744634753648409031256960588507, ...
    00.0898682948884483578932957925644586794, ...
    00.0666061141144875384911827609357715119, ...
    00.0271702286927384649428685037264585844, ...
    -0.0227079284235872438935111006230727071, ...
    -0.0749445841981264959663633362652035430, ...
    -0.1204597864262664658197010680851235520, ...
    -0.1513785524426082274018767748202662915, ...
    -0.1628843883655542723598586007938138209, ...
    -0.1539848792558933532337306360204820521, ...
    -0.1268505607423361936092476298654219136, ...
    -0.0856786398797793058434990598470903933, ...
    -0.0357128225646816330196564592824870488, ...
    00.0170029721039677006455548280428047292, ...
    00.0659128270164397456198912550462409854, ...
    00.1047113257384247042569569430270348676, ...
    00.1285950613590024771415443183286697604, ...
    00.1356317461875886920541489644165267237, ...
    00.1271031823069724009389602770170313306, ...
    00.1064639683257778413061345190726569854, ...
    00.0783146636884565622294118725221778732, ...
    00.0474898034938059376841579251049552113, ...
    00.0184100193477294317434544979050770053, ...
    -0.0052836667034016487898284708535356913, ...
    -0.0210237940858651432829429239745877567, ...
    -0.0277752454168756074404100786523486022, ...
    -0.0261947405453063324187734650649872492, ...
    -0.0182651614314788303394809787505437271, ...
    -0.0067882304745692668285217408197240729, ...
    00.0052562379418543830889021251095982734, ...
    00.0153043199645893582966360568775598949, ...
    00.0215019670457145470332527281698276056, ...
    00.0227147784969133348376146841474110261, ...
    00.0185276445824824331776170538432779722, ...
    00.0095852069040403969912844672762730625, ...
    -0.0025469799394153783828054216087366513, ...
    -0.0158249410987525915284201971644506557, ...
    -0.0283927541476951088295077596512783202, ...
    -0.0388329485209460492645128226740780519, ...
    -0.0462120348717993123521807774523040280, ...
    -0.0499192599326793162717308405262883753, ...
    -0.0494606304374154773229044224081007997, ...
    -0.0448083238367708025506885860522743315, ...
    -0.0366271777338240261956414656197011936, ...
    -0.0262917623225484668736395832411290030, ...
    -0.0154692128225804321345338010473824397, ...
    -0.0057469725263633022679932160770022165, ...
    00.0019420496989333026725821351732292896, ...
    00.0074908936860340093188970200799303711, ...
    00.0111802230538658765868209599148030975, ...
    00.0131226330172346857677601050795601623, ...
    00.0133524054734297445423685246623790590, ...
    00.0121435077403544977592275699862511829, ...
    00.0101391992514035713529585436276647670, ...
    00.0083160147040678058377727310812588257, ...
    00.0076516740516603268598694320701270044, ...
    00.0086661272353156949127539476762649429, ...
    00.0111438696580202899893974333167534496, ...
    00.0143234139778121091768348094319662778, ...
    00.0173561812625133184140313602483729483, ...
    00.0195852427735312591139393845196536859, ...
    00.0206845088697691394108435503085274831, ...
    00.0205378213669760861792568107375700492, ...
    00.0190397873274520089414973966768229729, ...
    00.0161288691101028405783246455484913895, ...
    00.0121464304576783307249021603979599604, ...
    00.0077250447822075647003048359806598455, ...
    00.0034373077666560378218285620732785901, ...
    -0.0003142233624469829389273811681704274, ...
    -0.0033263807136597596351978989304143397, ...
    -0.0054541783855811846667971387603301991, ...
    -0.0067400139048459511981192804341844749, ...
    -0.0073308737843852155371959788965341431, ...
    -0.0073641564282383841638646160276948649, ...
    -0.0069587530015243282202619390375275543, ...
    -0.0062905065844669439886760464730741660, ...
    -0.0055264313631176930838306837756590539, ...
    -0.0047583259826677300544095494672092173, ...
    -0.0040179162414817701926006421331294405, ...
    -0.0033206183137242523129017968130938243, ...
    -0.0026862979155912966068575631339854226, ...
    -0.0021386795779130642926324501473800410, ...
    -0.0016771542837529069495255962252144855, ...
    -0.0012831916364849636248701703067354174, ...
    -0.0009335963628861433053623963829181776, ...
    -0.0006280348985215005548285449599177355, ...
    -0.0003804492622126403158014373850903667, ...
    -0.0001965138120462484613935189026179273, ...
    -0.0000661013570423040841897432962070980, ...
    00.0000160980756505875440356707201106090, ...
    00.0000553085409721979320255176582055157, ...
    00.0000580442258646555125185459433900803, ...
    00.0000376342378346587182972454721507916, ...
    00.0000120567925621379802212079085377283, ...
    00.0000000000000000000000000000000000000, ...
    ];

fs_orig = 70e6;

if fs_orig == fs,
    h_out = h;
else
    ratio = fs/fs_orig;
    [P Q] = rat(ratio);
    h_out = resample(h, P, Q, 30);
end
